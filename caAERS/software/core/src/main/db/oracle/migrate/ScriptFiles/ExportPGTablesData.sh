#!/bin/bash
EXTENSION='.txt'
USERNAME='postgres'
DBNAME='database_name'
PORT=5432
HOST='localhost'
declare -a TABLENAMES=('additional_info_document' 'additional_information' 'adverse_events' 'adverseevent_index' 'ae_attributions' 'ae_behavioral_interventions' 'ae_biological_interventions' 'ae_cause_types' 'ae_dietary_interventions' 'ae_genetic_interventions' 'ae_labs' 'ae_medical_devices' 'ae_other_interventions' 'ae_pre_existing_conds' 'ae_prior_therapies' 'ae_radiation_interventions' 'ae_recom_reports' 'ae_report_descriptions' 'ae_report_people' 'ae_reporting_periods' 'ae_reports' 'ae_routine_reports' 'ae_surgery_interventions' 'ae_terms' 'agent_terms' 'agents' 'anatomic_sites' 'arms' 'audit_event_values' 'audit_events' 'caaers_bootstrap_log' 'caaers_field_defs' 'caaers_users' 'chemo_agents' 'concomitant_medications' 'conditions' 'config_properties' 'configuration' 'contact_mechanisms' 'course_agents' 'csm_application' 'csm_filter_clause' 'csm_group' 'csm_mapping' 'csm_pg_pe' 'csm_privilege' 'csm_protection_element' 'csm_protection_group' 'csm_role' 'csm_role_privilege' 'csm_user' 'csm_user_group' 'csm_user_group_role_pg' 'csm_user_pe' 'ctc_categories' 'ctc_grades' 'ctc_terms' 'ctc_versions' 'devices' 'disease_categories' 'disease_histories' 'disease_terminologies' 'disease_terms' 'epochs' 'expected_aes' 'expedited_ae_index' 'ext_adverse_events' 'ext_ae_reporting_prds' 'handles' 'identifiers' 'ind_holders' 'integration_log_details' 'integration_log_message' 'integration_logs' 'intervention_sites' 'investigational_new_drugs' 'investigator_index' 'investigators' 'lab_categories' 'lab_terms' 'lab_versions' 'labs' 'mandatory_field_defs' 'meddra_hlgt' 'meddra_hlgt_hlt' 'meddra_hlt' 'meddra_hlt_pt' 'meddra_llt' 'meddra_pt' 'meddra_soc' 'meddra_soc_hlgt' 'meddra_versions' 'metastatic_disease_sites' 'nas' 'notifications' 'observed_ae_profiles' 'organization_index' 'organizations' 'other_causes' 'other_interventions' 'outcomes' 'participant_assignments' 'participant_histories' 'participant_index' 'participants' 'password_history' 'password_policy' 'planned_notifications' 'pre_existing_conditions' 'prior_therapies' 'prior_therapy_agents' 'recipients' 'reconciled_adverse_events' 'reconciliation_reports' 'report_calendar_templates' 'report_deliveries' 'report_delivery_defs' 'report_format' 'report_index' 'report_schedules' 'report_tracking' 'report_tracking_status' 'report_versions' 'reported_adverse_events' 'reportingperiod_index' 'research_staffs' 'researchstaff_index' 'role_privilege' 'rule_sets' 'scheduled_notifications' 'searches' 'site_investigators' 'site_research_staffs' 'site_rs_staff_roles' 'solicited_events' 'spa_concomitant_medications' 'spa_disease_histories' 'spa_metastatic_disease_sites' 'spa_pre_existing_conds' 'spa_prior_therapies' 'spa_prior_therapy_agents' 'studies' 'study_agent_inds' 'study_agents' 'study_amendments' 'study_device_inds' 'study_devices' 'study_diseases' 'study_index' 'study_interventions_exp_aes' 'study_investigators' 'study_organizations' 'study_personnel' 'study_site_wf_cfgs' 'study_therapy' 'ta_agents' 'ta_devices' 'ta_expected_ae_intervention' 'ta_other_interventions' 'ta_study_interventions' 'task_configuration' 'terminologies' 'treatment_assignment' 'treatments' 'wf_assignees' 'wf_review_comments' 'wf_transition_configs' 'wf_transition_owners' 'workflow_configuration');	echo ${#TABLENAMES[@]}
for(( i=0;i<${#TABLENAMES[@]};i++)) do 
if [ "${TABLENAMES[i]}" = "report_tracking_status" ] ; then
  psql -h $HOST -U $USERNAME -d $DBNAME -p $PORT -A -t -c  "\COPY (SELECT ID, VERSION, STATUS, SUBSTRING(STATUS_MESSAGE, 1, 3500), RECORDED_TIME, GRID_ID from ${TABLENAMES[i]}) to ${TABLENAMES[i]}${EXTENSION} NULL ''"
elif [ "${TABLENAMES[i]}" = "audit_event_values" ] ; then
  psql -h $HOST -U $USERNAME -d $DBNAME -p $PORT -A -t -c  "\COPY (SELECT ID, AUDIT_EVENT_ID, ATTRIBUTE_NAME, SUBSTRING(PREVIOUS_VALUE, 1, 3500), SUBSTRING(NEW_VALUE,1, 3500), VERSION from ${TABLENAMES[i]}) to ${TABLENAMES[i]}${EXTENSION} NULL ''"
elif [ "${TABLENAMES[i]}" = "report_versions" ] ; then
  psql -h $HOST -U $USERNAME -d $DBNAME -p $PORT -A -t -c  "\COPY (SELECT ID, CREATED_ON, DUE_ON, SUBMITTED_ON, WITHDRAWN_ON, STATUS_CODE, PHYSICIAN_SIGNOFF, EMAIL, REPORT_ID, LIST_INDEX, VERSION, GRID_ID, REPORT_VERSION_ID, ASSIGNED_IDENTIFER, SUBSTRING(SUBMISSION_MESSAGE,1, 3500), SUBMISSION_URL, AMENDED_ON, AMENDMENT_NUMBER from ${TABLENAMES[i]}) to ${TABLENAMES[i]}${EXTENSION} NULL ''"
else
  psql -h $HOST -U $USERNAME -d $DBNAME -p $PORT -A -t -c  "\COPY ${TABLENAMES[i]} to ${TABLENAMES[i]}${EXTENSION} NULL ''"
fi
done