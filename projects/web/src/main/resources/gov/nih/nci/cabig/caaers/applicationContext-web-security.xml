<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:aop="http://www.springframework.org/schema/aop"
	xmlns:util="http://www.springframework.org/schema/util"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.0.xsd
http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-2.0.xsd">


	<util:map id="taskObjectPrivilegeMap">

		<!--========== PARTICIPANT ===========-->
		<entry key="/pages/participant/create"
			value="gov.nih.nci.cabig.caaers.domain.Participant:CREATE" />
		<entry key="/pages/participant/view"
			value="gov.nih.nci.cabig.caaers.domain.Participant:READ" />
		<entry key="/pages/participant/assign"
			value="gov.nih.nci.cabig.caaers.domain.Participant:UPDATE" />
		<entry key="/pages/participant/assignStudy"
			value="gov.nih.nci.cabig.caaers.domain.Participant:UPDATE" />
		<entry key="/pages/participant/assignParticipant"
			value="gov.nih.nci.cabig.caaers.domain.Participant:UPDATE" />

		<!--========== STUDY ===========-->
		<entry key="/pages/study/create"
			value="gov.nih.nci.cabig.caaers.domain.Study:CREATE" />
		<entry key="/pages/study/view"
			value="gov.nih.nci.cabig.caaers.domain.Study:READ" />
		<entry key="/pages/study/search"
			value="gov.nih.nci.cabig.caaers.domain.Study:READ" />
		<entry key="/pages/study/edit"
			value="gov.nih.nci.cabig.caaers.domain.Study:UPDATE" />

		<!--========== ADVERSE EVENT REPORT ===========-->
		<entry key="/pages/ae/create"
			value="gov.nih.nci.cabig.caaers.domain.ExpeditedAdverseEventReport:CREATE" />
		<entry key="/pages/ae/createRoutine"
			value="gov.nih.nci.cabig.caaers.domain.ExpeditedAdverseEventReport:CREATE" />
		<entry key="/pages/ae/edit"
			value="gov.nih.nci.cabig.caaers.domain.ExpeditedAdverseEventReport:UPDATE" />
		<entry key="/pages/ae/editRoutine"
			value="gov.nih.nci.cabig.caaers.domain.ExpeditedAdverseEventReport:UPDATE" />
		<entry key="/pages/ae/list"
			value="gov.nih.nci.cabig.caaers.domain.ExpeditedAdverseEventReport:READ" />

		<!--========== TODO: REPORT ===========-->

		<!--========== TODO: ADMIN ===========-->
		<entry key="/pages/admin/configure"
			value="gov.nih.nci.cabig.caaers.domain.Rule:CREATE"/>
		<entry key="/pages/admin/configure"
			value="gov.nih.nci.cabig.caaers.domain.Rule:CREATE"/>
		<entry key="/pages/admin/createInvestigator"
			value="gov.nih.nci.cabig.caaers.domain.Rule:CREATE"/>
		<entry key="/pages/admin/viewInvestigator"
			value="gov.nih.nci.cabig.caaers.domain.Rule:CREATE"/>
		<entry key="/pages/admin/createResearchStaff"
			value="gov.nih.nci.cabig.caaers.domain.Rule:CREATE"/>
		<entry key="/pages/admin/viewResearchStaff"
			value="gov.nih.nci.cabig.caaers.domain.Rule:CREATE"/>
		<entry key="/pages/admin/import"
			value="gov.nih.nci.cabig.caaers.domain.Rule:CREATE"/>
		<entry key="/pages/admin/importMeddra"
			value="gov.nih.nci.cabig.caaers.domain.Rule:CREATE"/>	
		<entry key="/pages/admin/createIND"
			value="gov.nih.nci.cabig.caaers.domain.Rule:CREATE"/>	<!--  TODO: need to change domain class -->
		<entry key="/pages/admin/createOrganization"
			value="gov.nih.nci.cabig.caaers.domain.Rule:CREATE"/>	
		
				
		<!--========= RULES ========-->
		<entry key="/pages/rule/create" value="gov.nih.nci.cabig.caaers.domain.Rule:CREATE"/>
		<entry key="/pages/rule/list" value="gov.nih.nci.cabig.caaers.domain.Rule:READ"/>
		<entry key="/pages/rule/addRule" value="gov.nih.nci.cabig.caaers.domain.Rule:CREATE"/>
		<entry key="/pages/rule/addColumn" value="gov.nih.nci.cabig.caaers.domain.Rule:CREATE"/>
		<entry key="/pages/rule/notification/create" value="gov.nih.nci.cabig.caaers.domain.Rule:CREATE"/>
		<entry key="/pages/rule/notification/list" value="gov.nih.nci.cabig.caaers.domain.Rule:CREATE"/>
		<entry key="/pages/rule/deploy" value="gov.nih.nci.cabig.caaers.domain.Rule:CREATE"/>
		
		<!--========= SEARCH ========-->
		<entry key="/pages/search/study" value="gov.nih.nci.cabig.caaers.domain.Study:READ"/>
		<entry key="/pages/search/participant" value="gov.nih.nci.cabig.caaers.domain.Participant:READ"/>
		<entry key="/pages/search/adverseEvent" value="gov.nih.nci.cabig.caaers.domain.Study:READ"/>
		<entry key="/pages/search/report" value="gov.nih.nci.cabig.caaers.domain.Study:READ"/>
		<entry key="/pages/search/routineReport" value="gov.nih.nci.cabig.caaers.domain.Study:READ"/>
		<entry key="/pages/search/searchIND" value="gov.nih.nci.cabig.caaers.domain.Study:READ"/><!--  TODO: need to change domain class -->
		

	</util:map>
	

	<bean id="taskPrivilegeAndObjectIdGenerator"
		class="gov.nih.nci.cabig.caaers.web.security.TaskPrivilegeAndObjectIdGenerator">
		<property name="objectPrivilegeMap"
			ref="taskObjectPrivilegeMap" />
	</bean>

	<bean id="taskAuthorizationCheck"
		class="gov.nih.nci.security.acegi.csm.authorization.DelegatingObjectPrivilegeCSMAuthorizationCheck">
		
		<property name="authorizationSwitch" ref="authorizationSwitch"/>
		
		<property name="csmAuthorizationCheck">
			<bean
                class="gov.nih.nci.security.acegi.grid.authorization.CSMGridGroupAuthorizationCheck">
				<property name="csmUserProvisioningManager" ref="csmUserProvisioningManager" />
                <property name="authorizationSwitch" ref="authorizationSwitch"/>
            </bean>

		</property>
		<property name="objectIdGenerator"
			ref="taskPrivilegeAndObjectIdGenerator" />
		<property name="privilegeGenerator"
			ref="taskPrivilegeAndObjectIdGenerator" />
	</bean>
	

	<util:map id="sectionObjectPrivilegeMap">
		<entry key="/pages/ae/list" value="gov.nih.nci.cabig.caaers.domain.ExpeditedAdverseEventReport:READ"/>
		<entry key="/pages/study/search" value="gov.nih.nci.cabig.caaers.domain.Study:READ"/>
		<entry key="/pages/participant/create" value="gov.nih.nci.cabig.caaers.domain.Participant:CREATE"/>
		<entry key="/pages/report/notImplemented" value="gov.nih.nci.cabig.caaers.domain.Rule:CREATE"/>
		<entry key="/pages/rule/create" value="gov.nih.nci.cabig.caaers.domain.Rule:CREATE"/>
		<entry key="/pages/admin/configure" value="gov.nih.nci.cabig.caaers.domain.Rule:CREATE"/>
		<entry key="/pages/search/study" value="gov.nih.nci.cabig.caaers.domain.Study:READ"/>
	</util:map>
	
	<bean id="sectionPrivilegeAndObjectIdGenerator"
		class="gov.nih.nci.cabig.caaers.web.security.SectionPrivilegeAndObjectIdGenerator">
		<property name="objectPrivilegeMap"
			ref="sectionObjectPrivilegeMap" />
	</bean>

	<bean id="sectionAuthorizationCheck"
		class="gov.nih.nci.security.acegi.csm.authorization.DelegatingObjectPrivilegeCSMAuthorizationCheck">
		
		<property name="authorizationSwitch" ref="authorizationSwitch"/>
		
		<property name="csmAuthorizationCheck">
		<!-- 
			<bean class="gov.nih.nci.cabig.caaers.web.security.RoleCheck"/>
 -->
			<bean class="gov.nih.nci.security.acegi.grid.authorization.CSMGridGroupAuthorizationCheck">
				<property name="csmUserProvisioningManager"
					ref="csmUserProvisioningManager" />
                <property name="authorizationSwitch" ref="authorizationSwitch"/>
			</bean>

		</property>
		<property name="objectIdGenerator"
			ref="sectionPrivilegeAndObjectIdGenerator" />
		<property name="privilegeGenerator"
			ref="sectionPrivilegeAndObjectIdGenerator" />
	</bean>
	
    <bean id="gridAuthenticationClient" class="gov.nih.nci.security.acegi.grid.authentication.GridBasicAuthenticationClientImpl">
    	<property name="idpUrl" value="https://localhost:58443/wsrf/services/cagrid/AuthenticationService"/>
		<property name="ifsUrl" value="https://localhost:28443/wsrf/services/cagrid/Dorian"/>
		<property name="proxyLifetimeHours" value="12"/>
		<property name="proxyLifetimeMinutes" value="0"/>
		<property name="proxyLifetimeSeconds" value="0"/>
		<property name="delegationPathLength" value="0"/>
    </bean>
    
    <bean id="gridProxyValidator" class="gov.nih.nci.security.acegi.grid.authentication.GridProxyValidatorImpl"/>
    
    <bean id="gridGroupSearch" class="gov.nih.nci.security.acegi.grid.authorization.CSMGridGroupSearch">
    	<property name="userProvisioningManager" ref="csmUserProvisioningManager"/>
    	<property name="csmApplicationContextName" ref="csmApplicationContextName"/>
    	<!-- Timeout per GridGrouperInstance -->
    	<property name="gridGrouperTimeout" value="10000"/>
    	<property name="gridGrouperClientFactory" ref="gridGrouperClientFactory"/>
    </bean>
    
    <bean id="gridGrouperClientFactory" class="gov.nih.nci.security.acegi.grid.authorization.DefaultGridGrouperClientFactory"/>	


</beans>
